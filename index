const OPENAI_API_KEY = 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; 

  function toggleChat() {
    const bot = document.querySelector('.chatbot');
    bot.style.display = bot.style.display === 'flex' ? 'none' : 'flex';
  }

  document.getElementById('send-btn').addEventListener('click', sendMessage);
  document.getElementById('user-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') sendMessage();
  });

  async function sendMessage() {
    const input = document.getElementById("user-input");
    const chatBody = document.getElementById("chat-body");

    const userText = input.value.trim();
    if (userText === "") return;

    // Display user message
    const userMsg = document.createElement("div");
    userMsg.className = "user-msg";
    userMsg.textContent = userText;
    chatBody.appendChild(userMsg);

    // Show thinking...
    const botMsg = document.createElement("div");
    botMsg.className = "bot-msg";
    botMsg.textContent = "Typing...";
    chatBody.appendChild(botMsg);
    chatBody.scrollTop = chatBody.scrollHeight;

    try {
      const res = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${OPENAI_API_KEY}`,
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [{ role: "user", content: userText }],
          max_tokens: 100,
          temperature: 0.7,
        }),
      });

      const data = await res.json();
      botMsg.textContent = data.choices[0].message.content;
    } catch (error) {
      console.error("Error:", error);
      botMsg.textContent = "Oops! Something went wrong.";
    }

    input.value = "";
    chatBody.scrollTop = chatBody.scrollHeight;
  }